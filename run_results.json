{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-18T22:44:53.150336Z", "invocation_id": "d6faf914-3c8d-480c-a533-4ac519560ede", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.663313Z", "completed_at": "2025-04-18T22:44:51.665307Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.683259Z", "completed_at": "2025-04-18T22:44:51.683259Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.039893388748168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.Business_Int.shipments_raw", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.648352Z", "completed_at": "2025-04-18T22:44:51.684257Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.686252Z", "completed_at": "2025-04-18T22:44:51.687249Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04488015174865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.stg_shipping_insights", "compiled": true, "compiled_code": "\n\nwith src as (\n\n  select\n    shipment_unique_key,\n    container_nbr,\n    shipment_type,\n    shipment_status,\n    voyage_number,\n    transshipment_cnt,\n\n    -- Shipper details\n    shipper_nme,\n    shipper_exchange_name,\n    shipper_ticker,\n    shipper_duns,\n    shipper_address,\n    shipper_city_nme,\n    shipper_state_nme,\n    shipper_postal_code,\n    shipper_country_nme,\n    shipper_phone_nbr,\n    shipper_sic4,\n\n    -- Requester details\n    requester_nme,\n    requester_exchange_name,\n    requester_ticker,\n    requester_duns,\n    requester_address,\n    requester_city_nme,\n    requester_state_nme,\n    requester_postal_code,\n    requester_country_nme,\n    requester_phone_nbr,\n    requester_sic4,\n\n    -- Secondary notify party\n    second_notify_party_nme,\n    second_notify_party_exchange_name,\n    second_notify_party_ticker,\n    second_notify_party_duns,\n    second_notify_party_address,\n    second_notify_party_city_nme,\n    second_notify_party_state_nme,\n    second_notify_party_postal_code,\n    second_notify_party_country_nme,\n    second_notify_party_phone_nbr,\n    second_notify_party_sic4,\n\n    -- Tertiary notify party\n    third_notify_party_nme,\n    third_notify_party_exchange_name,\n    third_notify_party_ticker,\n    third_notify_party_duns,\n    third_notify_party_address,\n    third_notify_party_city_nme,\n    third_notify_party_state_nme,\n    third_notify_party_postal_code,\n    third_notify_party_country_nme,\n    third_notify_party_phone_nbr,\n    third_notify_party_sic4,\n\n    -- Port of Receipt (Pickup) details\n    plor_unlocode,\n    plor_city_nme,\n    plor_country_nme,\n    plor_est_departure_tme,\n\n    -- Standardized port codes for analytics\n    departure_port_unlocode   as origin_port_code,\n    departure_port_city_nme   as origin_port_city,\n    departure_port_country_nme as origin_port_country,\n\n    destination_port_unlocode   as dest_port_code,\n    destination_port_city_nme    as dest_port_city,\n    destination_port_country_nme as dest_port_country,\n\n    -- Estimated vs actual timings\n    est_departure_tme,\n    est_arrival_tme,\n\n    -- Vessel & voyage details\n    vessel_nme,\n    vessel_imo_number,\n    vessel_load_tme,\n    vessel_departure_tme,\n    vessel_unload_tme,\n    vessel_arrival_tme,\n\n    -- Container return timestamp\n    return_tme,\n\n    -- Computed delay metrics (in hours)\n    timestampdiff(second, est_arrival_tme, vessel_arrival_tme)    / 3600.0 as arrival_delay_hours,\n    timestampdiff(second, est_departure_tme, vessel_departure_tme)/ 3600.0 as departure_delay_hours,\n\n    -- Transshipment flag\n    case when transshipment_cnt > 0 then true else false end as is_transshipped,\n\n    -- Surrogate key for joins\n    md5(shipment_unique_key || container_nbr) as shipment_sk,\n\n    -- Load timestamp for incremental logic\n    entry_tme\n\n  from BUSINESS_INT_DBT.PUBLIC.shipments_raw\n\n  \n    where entry_tme > (select max(entry_tme) from BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights)\n  \n\n)\n\nselect * from src", "relation_name": "BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.665307Z", "completed_at": "2025-04-18T22:44:51.685255Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.688246Z", "completed_at": "2025-04-18T22:44:51.688246Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04488015174865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Business_Int.source_not_null_dnb_shipping_insights_shipments_raw_entry_tme.22bc5490ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect entry_tme\nfrom BUSINESS_INT_DBT.PUBLIC.shipments_raw\nwhere entry_tme is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.677275Z", "completed_at": "2025-04-18T22:44:51.686252Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.689243Z", "completed_at": "2025-04-18T22:44:51.689243Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04487943649291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Business_Int.source_not_null_dnb_shipping_insights_shipments_raw_shipment_unique_key.8160649d4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shipment_unique_key\nfrom BUSINESS_INT_DBT.PUBLIC.shipments_raw\nwhere shipment_unique_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.694230Z", "completed_at": "2025-04-18T22:44:51.704203Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.718166Z", "completed_at": "2025-04-18T22:44:51.718166Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029920339584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Business_Int.source_unique_dnb_shipping_insights_shipments_raw_shipment_unique_key.af0f113ea1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    shipment_unique_key as unique_field,\n    count(*) as n_records\n\nfrom BUSINESS_INT_DBT.PUBLIC.shipments_raw\nwhere shipment_unique_key is not null\ngroup by shipment_unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.705201Z", "completed_at": "2025-04-18T22:44:51.719163Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.722155Z", "completed_at": "2025-04-18T22:44:51.722155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029919862747192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.dim_port", "compiled": true, "compiled_code": "\n\nselect distinct\n       origin_port_code as port_code,\n       origin_port_city as port_city,\n       origin_port_country as port_country,\n       'Origin' as port_role\nfrom BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights\n\nunion all\n\nselect distinct\n       dest_port_code   as port_code,\n       dest_port_city   as port_city,\n       dest_port_country as port_country,\n       'Destination'    as port_role\nfrom BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights", "relation_name": "BUSINESS_INT_DBT.PUBLIC_core.dim_port", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.709190Z", "completed_at": "2025-04-18T22:44:51.720161Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.723153Z", "completed_at": "2025-04-18T22:44:51.723153Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02991962432861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.dim_vessel", "compiled": true, "compiled_code": "\n\nselect\n    vessel_imo_number,\n    vessel_nme,\n    min(voyage_number)         as first_seen_voyage,\n    count(distinct voyage_number) as voyages_seen\nfrom BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights\nwhere vessel_imo_number is not null\ngroup by 1,2", "relation_name": "BUSINESS_INT_DBT.PUBLIC_core.dim_vessel", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.712183Z", "completed_at": "2025-04-18T22:44:51.721158Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.724151Z", "completed_at": "2025-04-18T22:44:51.724151Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021942615509033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.fct_leg_core", "compiled": true, "compiled_code": "\n\nwith src as (\n\n    select *\n    from BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights\n\n    \n      where entry_tme > (select max(entry_tme) from BUSINESS_INT_DBT.PUBLIC_core.fct_leg_core)\n    \n\n)\n\nselect\n    -- business grain\n    shipment_sk,\n    shipment_unique_key,\n    container_nbr,\n\n    1                                          as leg_sequence,       -- single\u2011leg sample\n\n    origin_port_code                           as departure_port_code,\n    dest_port_code                             as arrival_port_code,\n\n    vessel_departure_tme                       as actual_departure_tme,\n    vessel_arrival_tme                         as actual_arrival_tme,\n    est_departure_tme,\n    est_arrival_tme,\n\n    arrival_delay_hours,\n    departure_delay_hours,\n    transshipment_cnt,\n    is_transshipped,\n\n    -- date grains for clustering/partitioning\n    date(vessel_departure_tme)                 as leg_departure_date,\n    date_trunc('month', vessel_departure_tme::timestamp)  as leg_departure_month,\n    date(vessel_arrival_tme)                   as leg_arrival_date,\n\n    voyage_number,\n    vessel_nme,\n    vessel_imo_number,\n\n    md5(shipment_sk || '|' ||\n        origin_port_code || '|' ||\n        dest_port_code  || '|' ||\n        coalesce(vessel_departure_tme::string,''))  as leg_sk,\n\n    current_timestamp()                        as load_ts\nfrom src", "relation_name": "BUSINESS_INT_DBT.PUBLIC_core.fct_leg_core", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.728139Z", "completed_at": "2025-04-18T22:44:51.735121Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.744096Z", "completed_at": "2025-04-18T22:44:51.744096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02094292640686035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.fct_shipment", "compiled": true, "compiled_code": "\n\nwith src as (\n\n    select *\n    from BUSINESS_INT_DBT.PUBLIC_staging.stg_shipping_insights\n\n    \n      where entry_tme > (select max(entry_tme) from BUSINESS_INT_DBT.PUBLIC_core.fct_shipment)\n    \n\n)\n\nselect\n    shipment_sk,\n    shipment_unique_key,\n    container_nbr,\n    1                                   as leg_sequence,\n\n    origin_port_code                    as departure_port_code,\n    dest_port_code                      as arrival_port_code,\n\n    vessel_departure_tme                as actual_departure_tme,\n    vessel_arrival_tme                  as actual_arrival_tme,\n    est_departure_tme,\n    est_arrival_tme,\n\n    arrival_delay_hours,\n    departure_delay_hours,\n    transshipment_cnt,\n    is_transshipped,\n\n    date(vessel_departure_tme)          as leg_departure_date,\n    date_trunc('month', vessel_departure_tme::timestamp) as first_departure_month,\n    date(vessel_arrival_tme)            as leg_arrival_date,\n\n    voyage_number,\n    vessel_nme,\n    vessel_imo_number,\n\n    md5(shipment_sk || '|' ||\n        origin_port_code || '|' ||\n        dest_port_code  || '|' ||\n        coalesce(vessel_departure_tme::string,''))  as leg_sk,\n\n    current_timestamp()                 as load_ts\nfrom src", "relation_name": "BUSINESS_INT_DBT.PUBLIC_core.fct_shipment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.735121Z", "completed_at": "2025-04-18T22:44:51.740107Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.745094Z", "completed_at": "2025-04-18T22:44:51.745094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01795196533203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Business_Int.snap_dim_port", "compiled": true, "compiled_code": "\n\n\n\nselect\n    port_code,\n    port_city,\n    port_country\nfrom BUSINESS_INT_DBT.PUBLIC_core.dim_port\n", "relation_name": "BUSINESS_INT_DBT.PUBLIC_snapshots.snap_dim_port", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:44:51.741105Z", "completed_at": "2025-04-18T22:44:51.747089Z"}, {"name": "execute", "started_at": "2025-04-18T22:44:51.747089Z", "completed_at": "2025-04-18T22:44:51.747089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014960289001464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Business_Int.mart_kpi_reliability", "compiled": true, "compiled_code": "-- models/marts/mart_kpi_reliability.sql\n\n\n\nwith legs as (\n\n  select\n    shipment_sk,\n    departure_port_code     as origin_port_code,\n    arrival_port_code       as dest_port_code,\n\n    -- cast the VARCHAR timestamp to a true TIMESTAMP for date_trunc\n    cast(actual_departure_tme as timestamp_ntz) as departure_ts,\n\n    arrival_delay_hours,\n    transshipment_cnt\n\n  from BUSINESS_INT_DBT.PUBLIC_core.fct_leg_core\n\n),\n\nkpi as (\n\n  select\n    date_trunc('month', departure_ts)           as snapshot_month,\n    origin_port_code,\n    dest_port_code,\n    count(distinct shipment_sk)                 as shipment_count,\n    100 * avg(case when arrival_delay_hours <= 0 then 1 else 0 end)\n                                                as schedule_reliability_pct,\n    avg(arrival_delay_hours)                    as avg_arrival_delay_h,\n    avg(transshipment_cnt)                      as avg_transshipments,\n    max(arrival_delay_hours)                    as worst_delay_h\n  from legs\n  group by 1, 2, 3\n\n)\n\nselect * from kpi", "relation_name": "BUSINESS_INT_DBT.PUBLIC_marts.mart_kpi_reliability", "batch_results": null}], "elapsed_time": 18.52844762802124, "args": {"state_modified_compare_vars": false, "require_explicit_package_overrides_for_builtin_materializations": true, "which": "generate", "vars": {}, "show_resource_report": false, "require_yaml_configuration_for_mf_time_spines": false, "empty_catalog": false, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "invocation_command": "dbt docs generate", "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "cache_selected_only": false, "write_json": true, "print": true, "select": [], "project_dir": "C:\\Users\\Mattia\\Business_Int", "favor_state": false, "use_colors": true, "version_check": true, "require_resource_names_without_spaces": false, "require_nested_cumulative_type_params": false, "macro_debugging": false, "log_level_file": "debug", "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "introspect": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "exclude": [], "profiles_dir": "C:\\Users\\Mattia\\.dbt", "defer": false, "static": false, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "populate_cache": true, "send_anonymous_usage_stats": true, "partial_parse": true, "quiet": false, "log_format": "default", "log_path": "C:\\Users\\Mattia\\Business_Int\\logs", "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug"}}